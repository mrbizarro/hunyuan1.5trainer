# Cog configuration for HunyuanVideo 1.5 LoRA Training
build:
  gpu: true
  cuda: "12.4"
  python_version: "3.11"
  
  system_packages:
    - "libgl1-mesa-glx"
    - "libglib2.0-0"
    - "ffmpeg"
    - "git"
    - "wget"
  
  python_packages:
    - "torch==2.5.1"
    - "torchvision==0.20.1"
    - "torchaudio==2.5.1"
    - "accelerate==1.2.1"
    - "diffusers==0.32.2"
    - "transformers==4.47.0"
    - "safetensors==0.4.5"
    - "sentencepiece>=0.2.0"
    - "ftfy>=6.3.1"
    - "opencv-python>=4.10.0"
    - "einops>=0.8.1"
    - "toml>=0.10.2"
    - "imageio>=2.36.1"
    - "imageio-ffmpeg>=0.5.1"
    - "huggingface_hub>=0.27.0"
    - "peft>=0.14.0"
    - "bitsandbytes>=0.45.0"
    - "qwen-vl-utils>=0.0.10"
    - "av>=14.0.0"
    - "decord>=0.6.0"

  run:
    # Clone musubi-tuner (latest with 1.5 support)
    - "git clone https://github.com/kohya-ss/musubi-tuner.git /src/musubi-tuner"
    - "rm -f /src/musubi-tuner/.python-version"
    - "cd /src/musubi-tuner && pip install -e ."
    # Create model cache directory
    - "mkdir -p /src/models"

train: "train.py:train"
